import{k as ie,J as re,l as f,x as $,G as ne,r as w,i as de,f as ue,o as q,a,b as s,u as n,g as me,w as r,e as _,t as g,j as A,h as pe,c as fe,F as ve,aO as ce}from"./app-B8y3jIa7.js";import{h as H}from"./moment-C5S46NFB.js";import"./id-C3sGPiMz.js";const be={class:"flex flex-row gap-4"},we={class:"basis-1/3"},ge={class:"m-0 mb-5"},ye={class:"flex gap-4 mt-1"},ke={class:"basis-2/3"},xe={class:"w-full text-center flex gap-2"},Ce={class:"flex items-center gap-4 border border-primary bg-transparent rounded-full w-full py-1 px-2 justify-between"},Ve={class:"text-color font-medium"},_e={class:"hidden sm:block"},Pe={class:"block sm:hidden"},Ue={class:"flex items-center gap-4 mb-4"},je={class:"flex items-center gap-4 mb-8"},Ee={class:"flex justify-end gap-2"},Be={class:"flex flex-col items-center gap-4 mb-10"},De={class:"flex justify-center gap-2"},Me={class:"flex flex-col items-center"},Se={class:"flex flex-col items-start gap-4 mb-4"},Te={class:"flex flex-col items-start gap-4 mb-8"},Le={class:"flex justify-end gap-2"},Oe={class:"flex flex-col items-center"},$e={class:"flex flex-col items-start gap-2 mb-4 w-full"},Ae={class:"flex flex-col items-start gap-2 mb-4 w-full"},Ke={class:"flex flex-col items-start gap-2 mb-4 w-full"},Ne={class:"flex flex-col items-start gap-2 mb-8 w-full"},he={class:"flex justify-end gap-2"},Ge={__name:"View",props:{user:Object,activity:Object,lists:Object},setup(z){const u=ie(),J=re(),m=z,K=f(new Array),I=f(!0),i=f(!1),P=f(!1),U=f(!1),x=f(!1),j=f(!1),C=f(!1),M=f(null),v=f(null),y=f(null),V=()=>{K.value=[],m.lists&&m.lists.length>0&&m.lists.map(t=>{K.value.push(t)}),I.value=!1};V();const o=$({uuid:null,name:null,email:null,password:null}),p=$({uuid:null,password:null,password_confirm:null});ne(()=>{V()});const Z=()=>{var t,e,k;o.reset(),o.uuid=(t=m.user)==null?void 0:t.uuid,o.name=(e=m.user)==null?void 0:e.name,o.email=(k=m.user)==null?void 0:k.email,x.value=!0},Q=()=>{v.value&&y.value?(i.value=!0,ce.post(route("profile.password.check"),{uuid:y.value,password:btoa(v.value)}).then(t=>{t.data.status==="success"?(u.add({severity:"success",summary:"OK",detail:"Password sesuai",life:3e3}),C.value=!1,M.value==="password"?(p.reset(),p.uuid=y.value,j.value=!0):M.value==="user"&&le(y.value)):u.add({severity:"error",summary:"Error",detail:t.data.msg,life:3e3}),i.value=!1}).catch(t=>{console.log(t),i.value=!1})):u.add({severity:"error",summary:"Error",detail:"Password wajib diisi",life:3e3})},F=t=>{y.value=t,v.value=null,M.value="password",C.value=!0},R=()=>{p.password&&p.password_confirm?p.password===p.password_confirm?(i.value=!0,p.post(route("profile.password.update"),{resetOnSuccess:!0,onSuccess:t=>{const e=t.props.flash.message;S(e),V(),i.value=!1,j.value=!1,p.uuid===y.value&&$().post(route("logout"))},onError:()=>{i.value=!1,u.add({severity:"error",summary:"Peringatan",detail:"Terjadi kesalahan pada sistem",life:3e3})}})):u.add({severity:"error",summary:"Error",detail:"Password tidak sama",life:3e3}):u.add({severity:"error",summary:"Error",detail:"Harap mengisi semua data inputan",life:3e3})},W=t=>{console.log(t),t?(o.reset(),o.uuid=t.uuid,o.name=t.name,o.email=t.email,x.value=!0):u.add({severity:"error",summary:"Error",detail:"Data tidak ditemukan",life:3e3})},X=()=>{o.uuid&&o.name&&o.email?(i.value=!0,o.post(route("profile.update"),{resetOnSuccess:!0,onSuccess:t=>{const e=t.props.flash.message;S(e),V(),i.value=!1,x.value=!1},onError:()=>{i.value=!1,u.add({severity:"error",summary:"Peringatan",detail:"Terjadi kesalahan pada sistem",life:3e3})}})):u.add({severity:"error",summary:"Error",detail:"Data tidak lengkap",life:3e3})},Y=()=>{o.uuid=null,o.name=null,o.email=null,o.password=null,v.value=null,U.value=!0},ee=()=>{o.name&&o.email&&o.password?o.password===v.value?(i.value=!0,o.post(route("profile.user.new"),{resetOnSuccess:!0,onSuccess:t=>{const e=t.props.flash.message;S(e),V(),i.value=!1,U.value=!1},onError:()=>{i.value=!1,u.add({severity:"error",summary:"Peringatan",detail:"Terjadi kesalahan pada sistem",life:3e3})}})):u.add({severity:"error",summary:"Error",detail:"Password tidak sama",life:3e3}):u.add({severity:"error",summary:"Error",detail:"Inputan wajib diisi",life:3e3})},se=(t,e)=>{J.require({message:`Anda yakin ingin menghapus user ${e} ?`,header:"Danger Zone",icon:"pi pi-info-circle",rejectLabel:"Batal",rejectProps:{label:"Cancel",severity:"secondary",outlined:!0},acceptProps:{label:"Konfirmasi",severity:"danger"},accept:()=>{y.value=t,v.value=null,M.value="user",C.value=!0},reject:()=>{}})},le=t=>{if(t){const e=$({uuid:t});P.value=!0,e.post(route("profile.user.drop"),{resetOnSuccess:!0,onSuccess:k=>{const N=k.props.flash.message;S(N),V(),P.value=!1},onError:()=>{P.value=!1,u.add({severity:"error",summary:"Peringatan",detail:"Terjadi kesalahan pada sistem",life:3e3})}})}},S=t=>{t.status==="failed"?u.add({severity:"error",summary:"Error",detail:t.msg,life:3e3}):t.status==="success"&&u.add({severity:"success",summary:"Berhasil",detail:t.msg,life:3e3})};return(t,e)=>{const k=w("Toast"),N=w("ConfirmDialog"),d=w("Button"),G=w("Card"),h=w("Column"),ae=w("DataTable"),T=w("InputText"),E=w("Dialog"),B=w("Password"),L=de("tooltip");return q(),ue(ve,null,[a(k),a(N),a(n(me),{title:"Profile"}),s("div",be,[s("div",we,[a(G,{style:{width:"100%",overflow:"hidden"}},{header:r(()=>e[19]||(e[19]=[s("img",{alt:"user header",src:"https://primefaces.org/cdn/primevue/images/usercard.png"},null,-1)])),title:r(()=>{var l;return[_(g((l=m.user)==null?void 0:l.name),1)]}),subtitle:r(()=>e[20]||(e[20]=[_("admin")])),content:r(()=>{var l,c,b,D,O;return[s("p",ge,[_(g((l=m.user)==null?void 0:l.email)+" ",1),e[21]||(e[21]=s("br",null,null,-1)),e[22]||(e[22]=s("br",null,null,-1)),_(" Updated "+g((c=m.user)!=null&&c.updated_at?n(H)((b=m.user)==null?void 0:b.updated_at).format("LLL"):n(H)((D=m.user)==null?void 0:D.created_at).format("LL"))+" ",1),e[23]||(e[23]=s("br",null,null,-1)),_(" Last Activity "+g(n(H).unix((O=m.activity)==null?void 0:O.last_activity).format("LLL")),1)]),e[24]||(e[24]=s("label",null,"Â ",-1))]}),footer:r(()=>[s("div",ye,[a(d,{label:"Ubah Password",icon:"pi pi-lock",severity:"danger",outlined:"",class:"w-full",onClick:e[0]||(e[0]=l=>{var c;return F((c=m.user)==null?void 0:c.uuid)})}),a(d,{label:"Perbarui Data",icon:"pi pi-user-edit",class:"w-full",onClick:Z})])]),_:1})]),s("div",ke,[a(G,{class:"w-full"},{title:r(()=>e[25]||(e[25]=[s("i",{class:"pi pi-book"},null,-1),_(" Daftar Akun")])),content:r(()=>[a(ae,{value:K.value,paginator:"",showGridlines:"",rows:15,rowsPerPageOptions:[5,10,15,20,50],tableStyle:"min-width: 50rem",filterDisplay:"menu",dataKey:"id",loading:I.value},{header:r(()=>[a(d,{label:"Buat Akun Baru",icon:"pi pi-user-plus",severity:"success",onClick:Y})]),empty:r(()=>e[26]||(e[26]=[s("div",{class:"w-full text-center"},"Tidak ada data.",-1)])),loading:r(()=>e[27]||(e[27]=[s("div",{class:"w-full text-center"},"Memproses data. Harap menunggu.",-1)])),paginatorcontainer:r(({first:l,last:c,page:b,pageCount:D,prevPageCallback:O,nextPageCallback:te,totalRecords:oe})=>[s("div",Ce,[a(d,{icon:"pi pi-chevron-left",rounded:"",text:"",onClick:O,disabled:b===0},null,8,["onClick","disabled"]),s("div",Ve,[s("span",_e,"Showing "+g(l)+" to "+g(c)+" of "+g(oe),1),s("span",Pe,"Page "+g(b+1)+" of "+g(D),1)]),a(d,{icon:"pi pi-chevron-right",rounded:"",text:"",onClick:te,disabled:b===D-1},null,8,["onClick","disabled"])])]),default:r(()=>[a(h,{field:"name",header:"Nama User",style:{width:"20%"}}),a(h,{field:"email",header:"Email",style:{width:"20%"}}),a(h,{header:"Opsi",style:{width:"20%","text-align":"center"},class:"w-full text-center"},{body:r(l=>{var c;return[s("div",xe,[A(a(d,{icon:"pi pi-pencil",onClick:b=>W(l.data),severity:"secondary",rounded:""},null,8,["onClick"]),[[L,"Edit User",void 0,{bottom:!0}]]),A(a(d,{icon:"pi pi-key",onClick:b=>F(l.data.uuid),severity:"warn",rounded:""},null,8,["onClick"]),[[L,"Ubah Password",void 0,{bottom:!0}]]),l.data.uuid!=((c=m.user)==null?void 0:c.uuid)?A((q(),fe(d,{key:0,icon:"pi pi-trash",onClick:b=>se(l.data.uuid,l.data.name),severity:"danger",rounded:""},null,8,["onClick"])),[[L,"Hapus User "+l.data.name,void 0,{bottom:!0}]]):pe("",!0)])]}),_:1})]),_:1},8,["value","loading"])]),_:1})])]),a(E,{visible:x.value,"onUpdate:visible":e[4]||(e[4]=l=>x.value=l),modal:"",header:"Edit Profile",style:{width:"25rem"}},{default:r(()=>[e[30]||(e[30]=s("span",{class:"text-surface-500 dark:text-surface-400 block mb-8"},"Update Profile.",-1)),s("div",Ue,[e[28]||(e[28]=s("label",{for:"name",class:"font-semibold w-24"},"Name",-1)),a(T,{modelValue:n(o).name,"onUpdate:modelValue":e[1]||(e[1]=l=>n(o).name=l),id:"name",class:"flex-auto",maxlength:"25",autocomplete:"name",autofocus:""},null,8,["modelValue"])]),s("div",je,[e[29]||(e[29]=s("label",{for:"email",class:"font-semibold w-24"},"Email",-1)),a(T,{modelValue:n(o).email,"onUpdate:modelValue":e[2]||(e[2]=l=>n(o).email=l),id:"email",class:"flex-auto",autocomplete:"off",disabled:""},null,8,["modelValue"])]),s("div",Ee,[a(d,{type:"button",label:"Cancel",icon:"pi pi-times",severity:"secondary",onClick:e[3]||(e[3]=l=>x.value=!1)}),a(d,{type:"button",label:i.value?"Memproses...":"Simpan",icon:i.value?"pi pi-spin pi-spinner":"pi pi-save",onClick:X},null,8,["label","icon"])])]),_:1,__:[30]},8,["visible"]),a(E,{visible:C.value,"onUpdate:visible":e[7]||(e[7]=l=>C.value=l),modal:"",style:{width:"25rem"},closable:!1},{header:r(()=>e[31]||(e[31]=[s("span",{class:"text-2xl block mb-8 text-center w-full"},"Konfirmasi Password",-1)])),default:r(()=>[s("div",Be,[e[32]||(e[32]=s("label",{for:"password",class:"font-semibold"},"Masukkan Password Anda",-1)),a(B,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=l=>v.value=l),id:"password",autofocus:"",toggleMask:""},null,8,["modelValue"])]),s("div",De,[a(d,{type:"button",label:"Batalkan",icon:"pi pi-times",severity:"secondary",onClick:e[6]||(e[6]=l=>C.value=!1)}),a(d,{type:"button",label:i.value?"Memproses...":"Konfirmasi",icon:i.value?"pi pi-spin pi-spinner":"pi pi-save",onClick:Q},null,8,["label","icon"])])]),_:1},8,["visible"]),a(E,{visible:j.value,"onUpdate:visible":e[11]||(e[11]=l=>j.value=l),modal:"",header:"Ubah Password",style:{width:"25rem"}},{default:r(()=>[e[35]||(e[35]=s("span",{class:"text-surface-500 dark:text-surface-400 block mb-8 text-center w-full"},"Masukkan Password Baru",-1)),s("div",Me,[s("div",Se,[e[33]||(e[33]=s("label",{for:"password",class:"font-semibold"},"Password Baru",-1)),a(B,{modelValue:n(p).password,"onUpdate:modelValue":e[8]||(e[8]=l=>n(p).password=l),id:"password",toggleMask:"",autofocus:""},null,8,["modelValue"])]),s("div",Te,[e[34]||(e[34]=s("label",{for:"password_confirm",class:"font-semibold"},"Konfirmasi Password Baru",-1)),a(B,{modelValue:n(p).password_confirm,"onUpdate:modelValue":e[9]||(e[9]=l=>n(p).password_confirm=l),id:"password_confirm",toggleMask:""},null,8,["modelValue"])])]),s("div",Le,[a(d,{type:"button",label:"Cancel",icon:"pi pi-times",severity:"secondary",onClick:e[10]||(e[10]=l=>j.value=!1)}),a(d,{type:"button",label:i.value?"Memproses...":"Simpan",icon:i.value?"pi pi-spin pi-spinner":"pi pi-save",onClick:R},null,8,["label","icon"])])]),_:1,__:[35]},8,["visible"]),a(E,{visible:U.value,"onUpdate:visible":e[17]||(e[17]=l=>U.value=l),modal:"",header:"Buat Akun",style:{width:"35rem"}},{default:r(()=>[e[40]||(e[40]=s("span",{class:"text-surface-500 dark:text-surface-400 block mb-8 text-center w-full"},"Buat Akun Baru",-1)),s("div",Oe,[s("div",$e,[e[36]||(e[36]=s("label",{for:"name",class:"font-semibold"},"Name",-1)),a(T,{modelValue:n(o).name,"onUpdate:modelValue":e[12]||(e[12]=l=>n(o).name=l),id:"name",class:"flex-auto w-full",maxlength:"25",autocomplete:"name",autofocus:""},null,8,["modelValue"])]),s("div",Ae,[e[37]||(e[37]=s("label",{for:"email",class:"font-semibold"},"Email",-1)),A(a(T,{modelValue:n(o).email,"onUpdate:modelValue":e[13]||(e[13]=l=>n(o).email=l),id:"email",class:"flex-auto w-full",maxlength:"50",autocomplete:"email"},null,8,["modelValue"]),[[L,"Pastikan alamat email berbeda dengan yang sudah terdaftar",void 0,{focus:!0,top:!0}]])]),s("div",Ke,[e[38]||(e[38]=s("label",{for:"password",class:"font-semibold"},"Password",-1)),a(B,{modelValue:n(o).password,"onUpdate:modelValue":e[14]||(e[14]=l=>n(o).password=l),id:"password",toggleMask:""},null,8,["modelValue"])]),s("div",Ne,[e[39]||(e[39]=s("label",{for:"password_confirm",class:"font-semibold"},"Konfirmasi Password",-1)),a(B,{modelValue:v.value,"onUpdate:modelValue":e[15]||(e[15]=l=>v.value=l),id:"password_confirm",toggleMask:""},null,8,["modelValue"])])]),s("div",he,[a(d,{type:"button",label:"Batalkan",icon:"pi pi-times",severity:"secondary",onClick:e[16]||(e[16]=l=>U.value=!1)}),a(d,{type:"button",label:i.value?"Memproses...":"Simpan",icon:i.value?"pi pi-spin pi-spinner":"pi pi-save",onClick:ee},null,8,["label","icon"])])]),_:1,__:[40]},8,["visible"]),a(E,{visible:P.value,"onUpdate:visible":e[18]||(e[18]=l=>P.value=l),modal:"",style:{width:"35rem"},closable:!1,"pt:root:class":"!border-0 !bg-transparent","pt:mask:class":"backdrop-blur-sm"},{default:r(()=>e[41]||(e[41]=[s("div",{class:"flex flex-col gap-4 justify-center"},[s("div",{class:"flex-auto text-center"},[s("i",{class:"pi pi-spin pi-spinner-dotted",style:{"font-size":"5rem"}})]),s("div",{class:"flex-auto text-center"},[s("label",null,"Memproses...")])],-1)])),_:1,__:[41]},8,["visible"])],64)}}};export{Ge as default};
