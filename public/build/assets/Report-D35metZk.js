import{k as fe,l as m,x as R,G as pe,r as p,i as ce,f as B,o as k,a as t,u as i,g as ve,w as o,b as a,j as E,e as _,t as v,as as ge,at as be,c as H,h as $,F as xe,au as Y}from"./app-B8y3jIa7.js";import{h as g}from"./moment-C5S46NFB.js";import"./id-C3sGPiMz.js";import{s as ye}from"./index-B7id7D6o.js";import{s as ke}from"./index-B_rlOKwj.js";import{s as _e}from"./index-CtGM5BF0.js";const we={class:"mt-5"},De={class:"flex justify-between"},he={class:"flex w-6/12 gap-4"},Me={class:"w-full text-center"},Ve={class:"flex items-center gap-4 border border-primary bg-transparent rounded-full w-full py-1 px-2 justify-between"},Ye={class:"text-color font-medium"},Ce={class:"hidden sm:block"},Te={class:"block sm:hidden"},Be={class:"w-full"},je={class:"card flex flex-wrap gap-4 mb-8"},Fe={class:"flex-auto justify-items-center text-center"},Ue={key:2,class:"w-full text-center mt-5"},Ne={class:"mb-3"},Se={class:"card flex flex-wrap gap-4 justify-items-center"},Ie={class:"flex-auto gap-4 text-center"},Ee={class:"w-full"},$e={class:"card flex flex-wrap gap-4 w-45"},Ke={class:"flex-auto"},Oe={class:"flex-auto"},ze={class:"flex-auto"},Ae={class:"card flex flex-wrap gap-4 -mt-20"},Le={class:"flex-auto"},Je={class:"flex-auto"},Ge={class:"card flex flex-wrap gap-4 -mt-20"},Pe={class:"flex-auto"},Re={class:"card flex flex-wrap gap-4 -mt-10"},He={class:"flex-auto"},ll={__name:"Report",props:{lists:Object,dates:Object},setup(W){const f=W;g.locale("id");const j=fe(),K=m(!0),b=m([]),O=m(Array()),w=m(),Z=new Date,C=m(null),T=m(!1),F=m(!1),D=m(!1),n=R({uuid:null,nama:null,instansi:null,keperluan:null,tanggal:null,jam_mulai:null,jam_selesai:null}),h=R({file:null}),z=()=>{b.value=[],O.value=[],f.lists&&f.lists.length>0&&f.lists.map(s=>{b.value.push(s)}),f.dates&&f.dates.length>0&&f.dates.map(s=>{O.value.push({name:g(s.tanggal).format("DD MMM YYYY"),value:s.tanggal})}),K.value=!1},A=()=>{w.value={global:{value:null,matchMode:Y.CONTAINS},tanggal:{value:null,matchMode:Y.BETWEEN},nama:{value:null,matchMode:Y.CONTAINS},instansi:{value:null,matchMode:Y.CONTAINS},keperluan:{value:null,matchMode:Y.CONTAINS}}};A();const q=()=>{A(),C.value=null,z()},Q=s=>{const[e,r]=s;!e&&!r?b.value=f.lists:e&&!r?(console.log("start",g(e).format("YYYY-MM-DD")),f.lists.length>0?b.value=f.lists.filter(c=>{const u=g(e).format("YYYY-MM-DD"),x=g(c.tanggal).format("YYYY-MM-DD");return u===x}):b.value=[]):e&&r&&(f.lists.length>0?b.value=f.lists.filter(c=>{const u=g(e).format("YYYY-MM-DD"),x=g(r).format("YYYY-MM-DD"),d=g(c.tanggal).format("YYYY-MM-DD");return d>=u&&d<=x}):b.value=[])},X=()=>{C.value=null},U=m(null),N=m(!1),L=m(null),M=m({file:!1});function ee(s,e=2){if(!+s)return"0 Bytes";const r=1024,c=e<0?0:e,u=["Bytes","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],x=Math.floor(Math.log(s)/Math.log(r));return`${parseFloat((s/Math.pow(r,x)).toFixed(c))} ${u[x]}`}function le(s){const e=s.files[0],r=new FileReader;console.log(e),e.size<=5242880&&e.name.split(".").pop()==="xlsx"?(L.value=e.name+" ("+ee(e.size)+")",r.onload=async c=>{U.value=c.target.result,h.file=c.target.result,N.value=!0},M.value.file=!1,r.readAsDataURL(e)):(M.value.file=!0,j.add({severity:"error",summary:"Error",detail:"Ukuran file melebihi batas yang ditentukan",life:3e3}))}function ae(){U.value=null,h.file=null,N.value=!1}const J=()=>{h.file?M.value.file=!1:M.value.file=!0},te=()=>{J(),h.file?console.log(h):j.add({severity:"error",summary:"Error",detail:"Mohon untuk memilih file terlebih dahulu",life:3e3})},se=s=>{s?(n.uuid=s.uuid,n.nama=s.nama,n.instansi=s.instansi,n.keperluan=s.keperluan,n.tanggal=g(s.tanggal).format("DD MMMM YYYY"),n.jam_mulai=s.jam_masuk,n.jam_selesai=s.jam_keluar,T.value=!0):j.add({severity:"error",summary:"Error",detail:"Data tidak ditemukan atau tidak terdaftar",life:3e3})};return pe(()=>{z(),n.reset()}),(s,e)=>{const r=p("Toast"),c=p("ConfirmDialog"),u=p("Button"),x=p("DatePicker"),d=p("InputText"),V=p("Column"),oe=p("DataTable"),ne=p("Card"),ie=p("Message"),G=p("Dialog"),ue=p("Textarea"),S=ce("tooltip");return k(),B(xe,null,[t(r),t(c),t(i(ve),{title:"Laporan Buku Tamu"}),t(ne,{class:"w-full"},{title:o(()=>e[15]||(e[15]=[a("i",{class:"pi pi-address-book"},null,-1),_(" Laporan Buku Tamu")])),content:o(()=>[a("div",we,[t(oe,{filters:w.value,"onUpdate:filters":e[4]||(e[4]=l=>w.value=l),value:b.value,paginator:"",showGridlines:"",rows:15,rowsPerPageOptions:[5,10,15,20,50],tableStyle:"min-width: 50rem",filterDisplay:"menu",dataKey:"id",loading:K.value,globalFilterFields:["tanggal","nama","instansi","keperluan"]},{header:o(()=>[a("div",De,[a("div",he,[t(u,{type:"button",icon:"pi pi-filter-slash",label:"Bersihkan Filter",outlined:"",onClick:e[0]||(e[0]=l=>q())}),t(x,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=l=>C.value=l),selectionMode:"range",manualInput:!1,dateFormat:"dd/mm/yy",placeholder:"Filter Tanggal",maxDate:i(Z),showButtonBar:"",onValueChange:e[2]||(e[2]=l=>Q(l)),onClearClick:X,class:"w-4/12"},null,8,["modelValue","maxDate"])]),t(i(ge),null,{default:o(()=>[t(i(be),null,{default:o(()=>e[16]||(e[16]=[a("i",{class:"pi pi-search"},null,-1)])),_:1,__:[16]}),t(d,{modelValue:w.value.global.value,"onUpdate:modelValue":e[3]||(e[3]=l=>w.value.global.value=l),placeholder:"Pencarian"},null,8,["modelValue"])]),_:1})])]),empty:o(()=>e[17]||(e[17]=[a("div",{class:"w-full text-center"},"Tidak ada data.",-1)])),loading:o(()=>e[18]||(e[18]=[a("div",{class:"w-full text-center"},"Memproses data. Harap menunggu.",-1)])),paginatorcontainer:o(({first:l,last:y,page:I,pageCount:P,prevPageCallback:re,nextPageCallback:de,totalRecords:me})=>[a("div",Ve,[t(u,{icon:"pi pi-chevron-left",rounded:"",text:"",onClick:re,disabled:I===0},null,8,["onClick","disabled"]),a("div",Ye,[a("span",Ce,"Showing "+v(l)+" to "+v(y)+" of "+v(me),1),a("span",Te,"Page "+v(I+1)+" of "+v(P),1)]),t(u,{icon:"pi pi-chevron-right",rounded:"",text:"",onClick:de,disabled:I===P-1},null,8,["onClick","disabled"])])]),default:o(()=>[t(V,{field:"tanggal",header:"Tanggal Kedatangan",style:{width:"25%"}},{body:o(({data:l})=>[E((k(),B("label",null,[_(v(i(g)(l.tanggal).format("DD MMM YYYY")),1)])),[[S,l.jam_masuk+" - "+l.jam_keluar]])]),_:1}),t(V,{field:"nama",header:"Nama",style:{width:"20%"}},{body:o(({data:l})=>[_(v(l.nama),1)]),filter:o(({filterModel:l})=>[t(d,{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,type:"text",placeholder:"Cari Nama"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(V,{field:"instansi",header:"Instansi",style:{width:"20%"},showFilterMatchModes:!1},{body:o(({data:l})=>[_(v(l.instansi),1)]),filter:o(({filterModel:l})=>[t(d,{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,type:"text",placeholder:"Cari instansi"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(V,{field:"keperluan",header:"Keperluan",style:{width:"20%"},filterField:"keperluan",showFilterMatchModes:!1,filterMenuStyle:{width:"14rem"}},{body:o(l=>[E((k(),B("label",null,[_(v(l.data.keperluan.length>28?l.data.keperluan.substring(0,27)+"...":l.data.keperluan),1)])),[[S,l.data.keperluan.length>28?l.data.keperluan:"",void 0,{bottom:!0}]])]),filter:o(({filterModel:l})=>[t(d,{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,type:"text",placeholder:"Cari keperluan"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(V,{header:"Opsi",style:{width:"15%","text-align":"right"},class:"justify-items-center"},{body:o(l=>[a("div",Me,[E(t(u,{icon:"pi pi-search",onClick:y=>se(l.data),severity:"secondary",rounded:""},null,8,["onClick"]),[[S,"Lihat Detail",void 0,{bottom:!0}]])])]),_:1})]),_:1},8,["filters","value","loading"])])]),_:1}),t(G,{visible:F.value,"onUpdate:visible":e[6]||(e[6]=l=>F.value=l),modal:"",header:"Import Data",style:{width:"30rem"}},{default:o(()=>[a("div",Be,[t(i(ye),{onSubmit:te,class:"flex flex-col gap-4"},{default:o(()=>[a("div",je,[a("div",Fe,[e[22]||(e[22]=a("label",{for:"",class:"font-bold block"}," File excel (.xlsx, max 5 Mb) ",-1)),t(i(_e),{mode:"basic",onSelect:le,customUpload:"",auto:"",severity:"secondary",class:"p-button-outlined mb-3",accept:".xlsx",onBlur:J}),M.value.file?(k(),H(ie,{key:0,severity:"error",size:"small",variant:"simple"},{default:o(()=>e[19]||(e[19]=[_("File wajib diisi")])),_:1,__:[19]})):$("",!0),N.value?(k(),H(u,{key:1,type:"button",label:"Hapus",severity:"warn",icon:"pi pi-trash",raised:"",onClick:ae,disabled:D.value},null,8,["disabled"])):$("",!0),U.value?(k(),B("div",Ue,[t(i(ke),null,{default:o(()=>[e[20]||(e[20]=a("i",{class:"pi pi-file-excel",style:{"font-size":"2rem"}},null,-1)),e[21]||(e[21]=a("br",null,null,-1)),a("label",Ne,v(L.value),1)]),_:1,__:[20,21]})])):$("",!0)])]),a("div",Se,[a("div",Ie,[t(u,{type:"button",label:"Tutup",severity:"secondary",class:"col-3 btn-block mr-5",icon:"pi pi-times",raised:"",onClick:e[5]||(e[5]=l=>F.value=!1),disabled:D.value},null,8,["disabled"]),t(u,{type:"submit",label:D.value?"Mengunggah":"Konfirmasi",severity:"success",icon:D.value?"pi pi-spin pi-spinner":"pi pi-save",raised:"",disabled:D.value},null,8,["label","icon","disabled"])])])]),_:1})])]),_:1},8,["visible"]),t(G,{visible:T.value,"onUpdate:visible":e[14]||(e[14]=l=>T.value=l),maximizable:"",modal:"",header:"Detail Tamu",style:{width:"70rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{default:o(()=>[a("div",Ee,[a("div",$e,[a("div",Ke,[e[23]||(e[23]=a("label",{for:"",class:"font-bold block"}," Tanggal Kedatangan ",-1)),t(d,{modelValue:i(n).tanggal,"onUpdate:modelValue":e[7]||(e[7]=l=>i(n).tanggal=l),placeholder:"Tanggal Kedatangan",class:"w-full",readonly:""},null,8,["modelValue"])]),a("div",Oe,[e[24]||(e[24]=a("label",{for:"jam_mulai",class:"font-bold block"}," Jam Mulai ",-1)),t(d,{modelValue:i(n).jam_mulai,"onUpdate:modelValue":e[8]||(e[8]=l=>i(n).jam_mulai=l),placeholder:"Jam Mulai",class:"w-full",readonly:""},null,8,["modelValue"])]),a("div",ze,[e[25]||(e[25]=a("label",{for:"jam_selesai",class:"font-bold block"}," Jam Selesai ",-1)),t(d,{modelValue:i(n).jam_selesai,"onUpdate:modelValue":e[9]||(e[9]=l=>i(n).jam_selesai=l),placeholder:"Jam Selesai",class:"w-full",readonly:""},null,8,["modelValue"])])]),a("div",Ae,[a("div",Le,[e[26]||(e[26]=a("label",{for:"nama",class:"font-bold block"}," Nama Tamu ",-1)),t(d,{modelValue:i(n).nama,"onUpdate:modelValue":e[10]||(e[10]=l=>i(n).nama=l),placeholder:"Nama Tamu",class:"w-full",readonly:""},null,8,["modelValue"])]),a("div",Je,[e[27]||(e[27]=a("label",{for:"instansi",class:"font-bold block"}," Instansi ",-1)),t(d,{modelValue:i(n).instansi,"onUpdate:modelValue":e[11]||(e[11]=l=>i(n).instansi=l),placeholder:"Instansi",class:"w-full",readonly:""},null,8,["modelValue"])])]),a("div",Ge,[a("div",Pe,[e[28]||(e[28]=a("label",{for:"",class:"font-bold block"}," Keperluan ",-1)),t(ue,{modelValue:i(n).keperluan,"onUpdate:modelValue":e[12]||(e[12]=l=>i(n).keperluan=l),rows:"5",style:{resize:"none"},class:"w-full",readonly:""},null,8,["modelValue"])])]),a("div",Re,[a("div",He,[t(u,{type:"button",label:"Tutup",severity:"danger",class:"flex btn-block",icon:"pi pi-times",raised:"",onClick:e[13]||(e[13]=l=>T.value=!1)})])])])]),_:1},8,["visible"])],64)}}};export{ll as default};
